{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\Stefan Robu\\\\OneDrive\\\\Desktop\\\\school\\\\anul 3\\\\TD\\\\TD-front-back-BD\\\\CasinoAPI\\\\CasinoFrontend\\\\src\\\\pages\\\\LoginModal.tsx\",\n  _s = $RefreshSig$();\nimport { useState, useEffect, useRef } from \"react\";\nimport axios from \"axios\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst LoginModal = ({\n  onClose\n}) => {\n  _s();\n  const [email, setEmail] = useState(\"\");\n  const [password, setPassword] = useState(\"\");\n  const [errorMsg, setErrorMsg] = useState(\"\");\n  const [isLoading, setIsLoading] = useState(false);\n  const emailInputRef = useRef(null);\n  useEffect(() => {\n    var _emailInputRef$curren;\n    // focus pe input la mount\n    (_emailInputRef$curren = emailInputRef.current) === null || _emailInputRef$curren === void 0 ? void 0 : _emailInputRef$curren.focus();\n\n    // event listener Escape key\n    const handleEsc = e => {\n      if (e.key === \"Escape\") {\n        onClose();\n      }\n    };\n    window.addEventListener(\"keydown\", handleEsc);\n    return () => {\n      window.removeEventListener(\"keydown\", handleEsc);\n    };\n  }, [onClose]);\n  const handleLogin = async e => {\n    e.preventDefault();\n    if (isLoading) return; // previne multiple submit-uri\n\n    setErrorMsg(\"\");\n    const emailRegex = /^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/;\n    if (!emailRegex.test(email)) {\n      setErrorMsg(\"Te rog introdu un email valid.\");\n      return;\n    }\n    setIsLoading(true);\n    try {\n      const response = await axios.post(\"https://localhost:7201/api/Auth/login\", {\n        Email: email,\n        Parola: password\n      }, {\n        headers: {\n          \"Content-Type\": \"application/json\"\n        }\n      });\n      const user = response.data;\n      localStorage.setItem(\"clientId\", user.idClient);\n      window.location.href = \"/profile\";\n    } catch (err) {\n      if (err.response) {\n        switch (err.response.status) {\n          case 401:\n            setErrorMsg(\"Parola incorectă.\");\n            break;\n          case 404:\n            setErrorMsg(\"Contul nu există.\");\n            break;\n          case 400:\n            setErrorMsg(\"Datele introduse sunt invalide.\");\n            break;\n          default:\n            setErrorMsg(\"Eroare necunoscută.\");\n        }\n      } else {\n        setErrorMsg(\"Serverul nu răspunde.\");\n      }\n    } finally {\n      setIsLoading(false);\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"fixed inset-0 flex items-center justify-center bg-black/50 z-50\",\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"bg-white rounded-2xl shadow-xl p-8 max-w-md w-full relative\",\n      children: [/*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: onClose,\n        className: \"absolute top-3 right-3 text-gray-500 hover:text-red-500 text-xl font-bold\",\n        \"aria-label\": \"\\xCEnchide fereastra de autentificare\",\n        children: \"\\xD7\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 85,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"h2\", {\n        className: \"text-2xl font-bold mb-6 text-center text-indigo-800\",\n        children: \"Autentificare\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 92,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"form\", {\n        onSubmit: handleLogin,\n        className: \"space-y-4\",\n        children: [/*#__PURE__*/_jsxDEV(\"input\", {\n          ref: emailInputRef,\n          type: \"email\",\n          placeholder: \"Email\",\n          className: \"w-full p-3 border rounded-md\",\n          value: email,\n          onChange: e => setEmail(e.target.value),\n          required: true,\n          \"aria-label\": \"Email\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 96,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"password\",\n          placeholder: \"Parol\\u0103\",\n          className: \"w-full p-3 border rounded-md\",\n          value: password,\n          onChange: e => setPassword(e.target.value),\n          required: true,\n          \"aria-label\": \"Parol\\u0103\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 106,\n          columnNumber: 11\n        }, this), errorMsg && /*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"text-red-500 text-sm\",\n          children: errorMsg\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 115,\n          columnNumber: 24\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          type: \"submit\",\n          disabled: isLoading,\n          className: `w-full py-2 rounded-md text-white ${isLoading ? \"bg-indigo-400 cursor-not-allowed\" : \"bg-indigo-700 hover:bg-indigo-800\"}`,\n          children: isLoading ? \"Se autentifică...\" : \"Autentifică-te\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 116,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 95,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n        className: \"text-sm text-center mt-4\",\n        children: [\"Nu ai cont?\", \" \", /*#__PURE__*/_jsxDEV(\"a\", {\n          href: \"/register\",\n          className: \"text-indigo-600 underline\",\n          children: \"\\xCEnregistreaz\\u0103-te\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 130,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 128,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 84,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 83,\n    columnNumber: 5\n  }, this);\n};\n_s(LoginModal, \"SUgR6Rk/f85BDaW66jP3wmEya2E=\");\n_c = LoginModal;\nexport default LoginModal;\nvar _c;\n$RefreshReg$(_c, \"LoginModal\");","map":{"version":3,"names":["useState","useEffect","useRef","axios","jsxDEV","_jsxDEV","LoginModal","onClose","_s","email","setEmail","password","setPassword","errorMsg","setErrorMsg","isLoading","setIsLoading","emailInputRef","_emailInputRef$curren","current","focus","handleEsc","e","key","window","addEventListener","removeEventListener","handleLogin","preventDefault","emailRegex","test","response","post","Email","Parola","headers","user","data","localStorage","setItem","idClient","location","href","err","status","className","children","onClick","fileName","_jsxFileName","lineNumber","columnNumber","onSubmit","ref","type","placeholder","value","onChange","target","required","disabled","_c","$RefreshReg$"],"sources":["C:/Users/Stefan Robu/OneDrive/Desktop/school/anul 3/TD/TD-front-back-BD/CasinoAPI/CasinoFrontend/src/pages/LoginModal.tsx"],"sourcesContent":["import { useState, useEffect, useRef } from \"react\";\r\nimport axios from \"axios\";\r\n\r\nconst LoginModal = ({ onClose }: { onClose: () => void }) => {\r\n  const [email, setEmail] = useState(\"\");\r\n  const [password, setPassword] = useState(\"\");\r\n  const [errorMsg, setErrorMsg] = useState(\"\");\r\n  const [isLoading, setIsLoading] = useState(false);\r\n\r\n  const emailInputRef = useRef<HTMLInputElement>(null);\r\n\r\n  useEffect(() => {\r\n    // focus pe input la mount\r\n    emailInputRef.current?.focus();\r\n\r\n    // event listener Escape key\r\n    const handleEsc = (e: KeyboardEvent) => {\r\n      if (e.key === \"Escape\") {\r\n        onClose();\r\n      }\r\n    };\r\n    window.addEventListener(\"keydown\", handleEsc);\r\n\r\n    return () => {\r\n      window.removeEventListener(\"keydown\", handleEsc);\r\n    };\r\n  }, [onClose]);\r\n\r\n  const handleLogin = async (e: React.FormEvent) => {\r\n    e.preventDefault();\r\n    if (isLoading) return; // previne multiple submit-uri\r\n\r\n    setErrorMsg(\"\");\r\n\r\n    const emailRegex = /^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/;\r\n    if (!emailRegex.test(email)) {\r\n      setErrorMsg(\"Te rog introdu un email valid.\");\r\n      return;\r\n    }\r\n\r\n    setIsLoading(true);\r\n    try {\r\n      const response = await axios.post(\r\n        \"https://localhost:7201/api/Auth/login\",\r\n        {\r\n          Email: email,\r\n          Parola: password,\r\n        },\r\n        {\r\n          headers: {\r\n            \"Content-Type\": \"application/json\",\r\n          },\r\n        }\r\n      );\r\n\r\n      const user = response.data;\r\n      localStorage.setItem(\"clientId\", user.idClient);\r\n      window.location.href = \"/profile\";\r\n    } catch (err: any) {\r\n      if (err.response) {\r\n        switch (err.response.status) {\r\n          case 401:\r\n            setErrorMsg(\"Parola incorectă.\");\r\n            break;\r\n          case 404:\r\n            setErrorMsg(\"Contul nu există.\");\r\n            break;\r\n          case 400:\r\n            setErrorMsg(\"Datele introduse sunt invalide.\");\r\n            break;\r\n          default:\r\n            setErrorMsg(\"Eroare necunoscută.\");\r\n        }\r\n      } else {\r\n        setErrorMsg(\"Serverul nu răspunde.\");\r\n      }\r\n    } finally {\r\n      setIsLoading(false);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"fixed inset-0 flex items-center justify-center bg-black/50 z-50\">\r\n      <div className=\"bg-white rounded-2xl shadow-xl p-8 max-w-md w-full relative\">\r\n        <button\r\n          onClick={onClose}\r\n          className=\"absolute top-3 right-3 text-gray-500 hover:text-red-500 text-xl font-bold\"\r\n          aria-label=\"Închide fereastra de autentificare\"\r\n        >\r\n          ×\r\n        </button>\r\n        <h2 className=\"text-2xl font-bold mb-6 text-center text-indigo-800\">\r\n          Autentificare\r\n        </h2>\r\n        <form onSubmit={handleLogin} className=\"space-y-4\">\r\n          <input\r\n            ref={emailInputRef}\r\n            type=\"email\"\r\n            placeholder=\"Email\"\r\n            className=\"w-full p-3 border rounded-md\"\r\n            value={email}\r\n            onChange={(e) => setEmail(e.target.value)}\r\n            required\r\n            aria-label=\"Email\"\r\n          />\r\n          <input\r\n            type=\"password\"\r\n            placeholder=\"Parolă\"\r\n            className=\"w-full p-3 border rounded-md\"\r\n            value={password}\r\n            onChange={(e) => setPassword(e.target.value)}\r\n            required\r\n            aria-label=\"Parolă\"\r\n          />\r\n          {errorMsg && <p className=\"text-red-500 text-sm\">{errorMsg}</p>}\r\n          <button\r\n            type=\"submit\"\r\n            disabled={isLoading}\r\n            className={`w-full py-2 rounded-md text-white ${\r\n              isLoading\r\n                ? \"bg-indigo-400 cursor-not-allowed\"\r\n                : \"bg-indigo-700 hover:bg-indigo-800\"\r\n            }`}\r\n          >\r\n            {isLoading ? \"Se autentifică...\" : \"Autentifică-te\"}\r\n          </button>\r\n        </form>\r\n        <p className=\"text-sm text-center mt-4\">\r\n          Nu ai cont?{\" \"}\r\n          <a href=\"/register\" className=\"text-indigo-600 underline\">\r\n            Înregistrează-te\r\n          </a>\r\n        </p>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default LoginModal;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}